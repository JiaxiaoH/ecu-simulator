@startuml SID$10
title SID$10
start
    partition SID$10 #LightBlue{
    :Service $10 リクエスト・メッセージを受信;
        if (len(RequestMessage)<2)) then (no) 
            if (diagnosticSessionType legal) then (yes)
                partition checkReqBySession #LightGray{
                    switch(subfunction?)
                        case($01)
                            if(ECU Session legal) then (no)
                                :NRC=$7Eを返送;
                                stop
                            else(yes)
                                if(len(RequestMessage)!=2)) then (no)
                                    :ECU Session = $01;
                                    :$01を組み込んだポジレスを返送;
                                    stop
                                else(yes)
                                    :NRC=$13を返送; 
                                    stop
                                endif
                            endif 
                        case($02)
                            :...;
                        case($03)
                            if(ECU Session legal) then (no)
                                :NRC=$7Eを返送;
                                stop
                            else(yes)
                                if(len(RequestMessage)!=2)) then (no)
                                    :ECU Session = $03;
                                    :$03を組み込んだポジレスを返送;
                                    stop
                                else(yes)
                                    :NRC=$13を返送; 
                                    stop
                                endif
                            endif 
                        case($4C)
                            :...;
                        case($4D)
                            :...;
                        case($4E)
                            :...;
                        case($4F)
                            if(ECU Session legal?) then (no)
                                :NRC=$7Eを返送;
                                stop
                            elseif(Security解除?) then (no)
                                :NRC=$33を返送;
                                stop
                            else(yes)
                                if(len(RequestMessage)!=2)) then (no)
                                    :ECU Session = $4F;
                                    :$4Fを組み込んだポジレスを返送;
                                    stop
                                else(yes)
                                    :NRC=$13を返送; 
                                    stop
                                endif
                            endif 
                        endswitch
                }
            else(no)
                :NRC = $12のネガレスを返送;
                stop
            endif
        else (yes)
            :NRC = $13のネガレスを返送;
            stop
        endif
    }
stop
@enduml